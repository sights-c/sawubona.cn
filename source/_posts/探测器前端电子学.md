---
title: 探测器前端电子学
date: 2023-09-05 14:14:50
mathjax: true
tags:
- 电子学
- 探测器
categories:
- 读出电子学
---

## 信号到数据的转换
### 前端电子的主要功能和触发系统
#### 前端电子学的功能
前端电子学的主要功能就是抽取粒子探测器输出电信号的某些特征，转换为能够反映粒子特性的数据，供在线计算机读取和记录。
#### 系统读出的死时间
信号到数据的转换、读取和记录过程需要较长的时间，若系统在前一个信号的处理过程中不能处理下一个信号，则会出现死时间。
#### 触发系统
- 前端电子学的探测信号经过初步处理后传递给触发系统作为触发判选的原始条件。
- 触发系统根据在线计算机的信号来控制前端电子学的开放，或者进入复位状态。
- 在可读取数据时，开放的前端电子学会返回在线计算机一个信号，使其读取可用数据，以及进行下一步的处理。在数据末尾，前端电子也会返回一个信号，使在线计算机停止记数。
- 在数据处理过程中，在线计算通过触发系统使前端电子学进入复位等待状态。处理完之后，在线计算通过触发系统开放前端电子学。
![数据获取系统各部分的关系](https://z1.ax1x.com/2023/10/07/pPjY5Nj.png)

### 能量电荷转换与电荷测量
#### 探测器的能量电荷转换关系
粒子通过探测器时使探测器产生电离、激发或光电转换等过程。输出信号的电荷量往往正比于粒子在探测器中消耗掉的能量。设粒子在探测器中消耗掉的能量为$E$，得到的电子电荷的平均数为$N$，探测器的平均能量-电荷转换系数为$\theta$（对于一定的探测器，$\theta$是常数），则有$$N = \theta E$$

#### 电荷测量
电荷测量的一般方法是先将待测的电荷转换成电压（QAC），再将电压模拟量转换成数字量（ADC）。探测器的输出阻抗往往比后接电路的输入阻抗大得多，可以等效为一个电流源。在QAC中，可以让探测器的输出电流$i$对一个固定电容$C$充电实现电荷电压转换：$$\int idt = Q = CU$$

### QAC的三种的方法
#### 电荷灵敏放大器方法
根据负反馈放大器的原理，如果放大器的增益足够大，带宽足够宽，输入阻抗足够高，则放大器的输出电压$V_o$和输入电荷$Q_i$的关系为：$$V_o = \frac{Q_i}{C_f}$$
- 优势
    放大器的输入端并联了探测器的输出阻抗、放大器的输入阻抗以及分布电容由于虚地的影响，对输入电流的分流作用极小，使得放大器的输出电压和输入电荷一致性好，有很好的准确性和稳定性。
- 劣势
    反馈电容没有电荷释放通路，每次信号到来时的输出为所有信号及漏电的叠加，产生堆积现象。当反馈电容积累的电荷足够多时，输出电压将超过放大器的动态范围。而且，如果输入信号中存在偏置电流，隔直电容漏电和探测器漏电等直流成分时，输出电压也会不断积累。

如果在$C_f$上并联一个电阻$R_f$，则可使$C_f$上的电荷逐渐放掉，输出电压也会降下来。由于电阻$R$的存在，输入过程并非直流充电过程，输出脉冲的幅度不仅与输入电荷有关，而且与输入脉冲的宽度及时间常数$R_fC_f$有关。在相同输入电荷的情况下，输入脉冲越宽，时间常数越小，输出电压脉冲的幅度越小，这称为“弹道亏损”现象。

当输出电压上升到最大值$V_{max}$后，输出电压下降到$1/e$的时间为时间常数$R_fC_f$，其下降过程为指数过程$$v(t) = V_{max}e^{-t/RC}$$
![电荷灵敏放大器](https://z1.ax1x.com/2023/10/07/pPjYfHg.png)

#### 电压灵敏放大器方法
电压灵敏放大的方法是放大器的输入端直接接入探测器的输出端，通过放大器的输入端并联的探测器的输出电容$C_D$，放大器的输入电容$C_A$以及分布电容$C_S$来达到电荷到电压的转换。由于杂散电容的不稳定性，这种方法的稳定性较差。虽然可以通过并联一个较大的固定电容来改善稳定性，但这又降低了信号幅度，对信噪比不利。
![电压灵敏放大器](https://z1.ax1x.com/2023/10/07/pPjYgjf.png)

#### 电流灵敏放大器方法
把一个电流放大器接在探测器和积分电容之间，可以利用放大器输入阻抗小，输出阻抗大以及具有放大能力的特点，实现信号转换的稳定性。配合较大的积分电容可以减小杂散电容对输出的影响。但输入电流脉宽很窄，要求放大器很大的带宽，成本较高，对于单纯的电荷转换来说性价比不好。

在需要同时测量电荷量与时间的情况下，可以先对信号进行电流电压转换，然后一路借到甄别器获取时间信息，一路进行电压电流转换后接到积分电容获取电荷信息。其中电流-电压，电压-电路转换能够实现放大，等效于一个电流放大器，实现电流灵敏放大的方法。
![同时测量电荷和时间](https://z1.ax1x.com/2023/10/07/pPjYTCn.png)

### ADC的三种的方法
#### Flash ADC(FADC)
一个测量范围为$U_m$的m位FADC通过无源网络产生$2^m-1$个等差电压节点，一个节点的电压以及节点之间的压差为$U_m/2^m$，每个节点输入一个甄别器，一共$2^m-1$个甄别器。按节点电压从小到大编号甄别器，定位输出为1的甄别器的最大编号n，ADC就可以得到对应十进制n的m位二进制输出。这样的方法速度极快，但是需要大量元件，而且随着数位宽度逐倍增加。

#### 逐次比较ADC
逐次比较ADC实际上二分法对应的硬件结构。从最高位数置1开始逐位置1，然后通过DAC对结果转换产生比较电压接入甄别器，输入电压较大时该位数置0，输入电压较小时该位数置1，直至末尾然后输出m位二进制输出。逐次比较ADC元器件使用量比FADC
要少得多，但由于是串行输出，工作频率要比FADC低。

#### 分级ADC
分级FADC实际上串并行结合，把m位数码等分成块，先从高位数块开始，每一块数码通过FADC进行转换，输入减去高位数块的结果后送入低位数块最后实现ADC的m位二进制输出。这是一种这种的方法，能够兼顾速度和成本。

### 定时甄别的三种方法
#### 前沿触发定时
实际的信号都有一定的上升时间，可以用脉冲幅度甄别器来确定信号上升沿某一个电压值的出现时刻。当待测信号前沿上等于甄别阈电压时，甄别器置1，精确的定时甄别应该采用输出逻辑信号前沿和延迟都很小的高速甄别器件。

输入信号有一定的噪声，为了避免噪声触发甄别器，甄别阈值不能设置得太低，导致定时信号和探测器输出有一定得时间差。由于探测器输出信号的幅度和波形都是随机的，信号不同的上升速度使得阈值导致的定时误差也是随机变化的，这种现象称为**时间游动**。前沿触发定时无法消除时间游动。
![前沿触发定时电路](https://z1.ax1x.com/2023/10/07/pPjY4EQ.png)

#### 过零定时
![有过零点的双向信号](https://z1.ax1x.com/2023/10/07/pPjY73q.png)
如果信号是双向的，且信号的起始与过零的时间差不随信号幅度的变化，可以通过双向触发信号的差得到定时输出。假如输入信号是先为负值，后为正值的双向过零信号，通过预甄别器产生输入信号小于零比较的触发信号，触发信号展宽后作为使能控制过零甄别进行大于零比较，在使能信号的末端或者信号低于阈值时置零，从而在输出端输出较为准确的定时信号。这样的方法需要设法消除叠加在基线上的噪声的误触发。对于单极性信号，则可以通过微分电路转换为双极性信号进行定时。
![过零定时电路](https://z1.ax1x.com/2023/10/07/pPjYI4s.png)

#### 恒比定时
恒比定时是另一种减少时间游动的方法。如果探测器的输出信号是与幅度无关的$AF(t)（|F_{max}(t)|<=1）$，可以把输入分两路分别通过延迟时间为$t_d$的延时器和衰减系数为$q$的衰减器，然后分别输入甄别器的正端和负端。甄别点$t_0$满足$$AF(t-t_d) = qAF(t), q<1 \Rightarrow F(t-t_0)=qF(t_0)$$显然，$t_0$与信号幅度无关，仅与波形有关，可知甄别阈值以及甄别阈值与幅度的比值为$$V_t=qAF(t_0) \quad p = V_T/A = qF(t_0)$$ 甄别阈值和幅度的比值是一个的常数，即恒必定时。为使甄别阈大于零，$t_d$必须比信号的底宽$t_w$小。

如果$t_d$比信号最大值的出现时间$t_m$小，则甄别点有可能既落在信号$AF(t-t_d)$的前沿上，又落在信号$qAF(t)$的前沿上。当$t_d$和$q$都很小时，甄别点$t_0$离两个波形的起始点都很近。许多波形可看作一系列不同时间常数的指数常数的线性组合。当$t_0$离波形的起始点很近时，指数函数可以用一条直线来近似，即：$$F(t)=A_0 - A_1e^{-t/\tau_1} - A_2e^{-t\tau_2}-\cdots$$因为$A_0-A_1-A_2-\cdots=0$，当$t$比$\tau_1,\tau_2,\cdots$中的最小值还要小很多时$$F(t)\approx (A_1/\tau+A_2/\tau_2+\cdots)t=mt \quad \Rightarrow \quad Am(t_0-t_d)=qAmt_0$$因此$$t_0 = t_d/(1-q)$$也就是说定时点与幅度$A$及波形(前沿的上升速度$m$)都没有关系，即法使幅度和上升时间造成的时间游动都得以补偿，称为**幅度和上升时间补偿定时**。它是恒比定时的一个特例。

如果我们观察恒比定时甄别器正负两端之间的电压差$V_D(t)$，有$$V_D(t)=AF(t-t_d)-qAF(t)=A[F(t-t_d)-qF(t)]$$ $V_D(t)$是一个幅度系数为$A$的双极性过零信号。当$V_D(t)=0$时，甄别器被触发输出，也就是恒比定时本质上是过零定时。

为了获得比较好的性能，要对恒比定时的延迟和衰减对不同的信号波形进行细致的调节。调节不当不但性能差，甚至不能正常工作。当延迟时间$t_d$大于信号宽度$t_w$时，构成$V_D(t)$的正负两个信号分离，无法行程陡峭的过零点，可能出现乱定时。当$t_d$和$q$太小时，$V_D(t)$的负幅度太小，甄别器容易被噪声和其他干扰信号误触发。
![恒比定时电路](https://z1.ax1x.com/2023/10/07/pPjYWDS.png)

### TDC的三种方法
定时甄别电路检出待测信号参考信号的出现时刻后，分别形成一个Start信号和一个Stop信号，可以通过数字变换（TDC）电路将Start信号和Stop信号之间的时间间隔变成数码，供计算机读出。

一般来说，早出现的物理事件产生Start信号，晚出现的物理时间产生Stop信号，也可以将早出现的物理事件加上一个足够大的固定的延迟以后作为Stop信号。固定的延迟时间减去测得的时间间隔就是原来的时间间隔。
#### 计数式时间数字变换
这种TDC的基本原理是在Start和Stop信号的时间间隔内，用计数器测量一个频率稳定的振荡器的周期数。待测的时间间隔就是测得的周期数与振荡器周期的乘积。测量精度与频率精度有关，在进行小时间间隔测量时，要求振荡器有很高的频率，否则计数器无法获得足够的计数，无法保证精度。

#### 带游标的计数式时间数字变换
计数式TDC存在震荡频率和测量精度的矛盾。粒子探测器要求几十皮秒到纳秒的分辨率，至少应有1GHz以上的振荡频率。这样高频率的振荡器和计数器都很难制造。为了解决这个问题，有人提出了带游标的计数式时间数字变换方法。如果振荡器的周期为10ns，游标之间的时间间隔为1ns，则100MHz的振荡器和计数器就可以得到1ns的分辨率。

将一个周期为10ns的振荡信号延迟10次，每次延迟1ns，可以得到10个一次错开1ns的振荡波形。每个振荡波形分别与待测信号符合，在待测信号到达的时刻可以得到一组10bit的二进制数码。对这个数码按一定的规则进行编码，就可以得到待测信号符合，在待测信号到达的时刻可以得到一组10bit的二进制数码。对这个数码按一定的规则进行编码，就可以得到待测信号在该周期中的游标时间，误差为1ns。总时间为周期计数器测定的时间和游标时间的和。这种能够产生一系列延迟振荡波形的振荡器是有多个延迟单元的环形振荡器或延迟线锁相环，延迟单元的延迟时间可以由控制电压调节。可以采用锁相的方法将环形振荡器的周期或延迟线的总延迟时间锁定在一个精确的周期上，以保证时间分割的准确度。
#### 时间幅度变换(TAC)
另一种测量小时间间隔的方法是先将时间信息变换成幅度信息（TAC），再将幅度信息变换成数字信息（ADC）。

用一个恒流源对一个固定电容充电，可以实现时间幅度变换。假定恒流源的电流为$I$，固定电容为$C$，电容上的起始电压为零，经过时间$t$后电容上的电压为$U$，则$$U=\frac{I\times t}{C}$$使Start信号启动充电过程，而使Stop信号终止充电过程，则电容上的电压与Start信号和Stop信号之间的时间间隔成正比，用ADC测量这个电压得到的数字量也必然与时间间隔成正比。当然，每次测量结束后要及时将电容放电，为下一次测量做好准备。

## 参考文献
[1]谢一冈.粒子探测器与数据获取[J].科学出版社, 2003.
[2]Inc A D .Data conversion handbook[M]. 2004.